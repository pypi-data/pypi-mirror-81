language: python
python:
- '3.8'
cache: false
install:
- python -V
- pip install -U virtualenv
- virtualenv venv
- source venv/bin/activate
- pip install -U flit
- pip install -U pytest
- pip install -U mypy
- pip install -U yaqc
- pip install -U yaqd-core
- pip install -U yaq-traits
- pip install .
jobs:
  include:
  - stage: test
    name: mypy
    script: mypy yaqd_wright
  - stage: test
    name: entry-points
    script:
    - yaqd-wright-wl-motor --version
    - yaqd-wright-wl-motor -h
    - yaqd-wright-filter-wheel --version
    - yaqd-wright-filter-wheel -h
    - yaqd-wright-aerotech --version
    - yaqd-wright-aerotech -h
    - yaqd-wright-ingaas --version
    - yaqd-wright-ingaas -h
  - stage: test
    name: traits
    script: for i in yaqd_wright/*.avpr; do yaq-traits check $i; done
deploy:
  provider: script
  script: flit publish
  on:
    tags: true
  skip_cleanup: true
env:
  global:
  - secure: bETeMcou93mibWIXXq/tT91vqBbWofm/brZqeJvtsM3YGSpcaxcUjLmVPXfiCXs6wFxaAuTHIXZhWgkcFm7FrikQV00wjzDiBsaVHnHZcpIYle6dtl2IzsoHNm6Wlmig7totGaJLzr6OGTO/RI3qI0TvxQ5BUXjccZj8RVI8tWVU+tfDFa5I7qXgPWwzWPn6rfNsp1lWHKPPFkZEXfr20jDQM9CWH9gKEo+r2KtQVxRN0Kg0fakjtTv9h2bnqlC9qWcCJn9P2ry5S9hRVkO6ZLl1B3rX27eXNEFan0GX0BW9ZKI0zBG84xaJGqkR8txPm7kvPVvP0IPARID6s9/S9J+WvH8SmcSgnu/0YowbpX4L8425gY0oE1IO8la9ptf6K2r3yV+UYKsXBJVD+T3Wph+ifJPTjrCoeNA4PQxurbiKpFDVV+xNuFwpKAWWxvigYTAwxCCbLgao42ROgEimEZuLApO28KiZuy+Lqxc9eH3YK5EoyvwxIGQXIDexHV/zhoLEW++nKhsM7VGJbSkc4oCy3fM37g0df8Jpstf0rPyKfJtmgzDd1FEoRewn+pXpvExYN+p84s+hQaIuTSjAO7CtUo7V99dVLm6RhMMppS9aUFDfg+SFNtNSy+wmPSZIdEN0OXv++6dby+ZErObUcSNnZ9Nqsc39SjUGlYCBFJc=
  - secure: Scz/I/UZOcboA2pLraxTVq0BO5mYoh7D1SFZBpI8XAu8SM/Im+JEkyH8aVacR8WSB4C4VMewENn+Zd/rdgvg7pd+rBctk9T64ksdjXuQK8/v3KmPZWn5mTRwmInzyF42D2B7c35rhHze65SfFRZpH1ZjOYleWXll34Nf2QcKRZJtw5+SRq2Dp99lLWbZkeDqe71kSx770ihgC7WCRJb0zKKqA6DECdsk/YLXuxLp/HxaexJ5zjuHVEyY1pFrMqRp3x0kzBrTRDEmjCtFjAzvqaw5N7kfoAO8sYykOg8ZMEjPyCJFPJADt25+1TKH0nY/3oNxh7akDvA2ojemWIm1/8NmB0/6BnplkJ8ZBdmktTjw2V1gHB7baZIO3k8FqQQWUk36HaphyeLw1flIvyKmTn3TIi2xC/wVCsspuLn2if3Kly7259MrE8+B9nMMVs5tizmnnpnHMNxLgDR707KiE9+Rc08AVpFczqs/Bg8pju2LnBJT0VXb5V2uBGDMBbzAe8NTvQqHO+fbXBVrm0/bFayP5JhhUBIeYmg1d1GE94GcQR0aa4F19cYdGNgF2Fwnehkc0auJm6LclpUau7qEIAwjXo47ZKV1lSiKmOTsKNUD+guPYzPdeDnrTBRjJhiVfdM42zp98cODezWJOmYcM+/1XddNljkGg6Xm4fkYqL4=
